<!DOCTYPE html>
<html lang="es" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>browsed | Writeup</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@400;600;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="../../index.css">
</head>

<body>
    <nav class="top-nav">
        <div class="container">
            <div class="nav-content">
                <div class="nav-left">
                    <a href="../../index.html" class="back-link" title="Back to home">‚Üê</a>
                    <h1 data-i18n="site-title">KDW_LABS</h1>
                </div>
                <div class="nav-controls">
                    <button id="theme-toggle" class="icon-btn" aria-label="Toggle theme">
                        <span class="theme-icon">üåô</span>
                    </button>
                    <button id="lang-toggle" class="icon-btn" aria-label="Toggle language">
                        <span>EN</span>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <main class="container">
        <header class="machine-header">
            <h1 class="machine-title">browsed</h1>
            <div class="machine-meta">
                <span class="badge badge-platform">HTB</span>
                <span class="badge badge-difficulty-medium">medium</span>
                <span class="badge badge-technique">Chrome Addon Data Exfiltration</span>
                <span class="badge badge-technique">Arithmetic Expansion RCE</span>
                <span class="badge badge-technique">PyCache Poisoning</span>
                <span class="badge badge-technique">SUID Privilege Escalation</span>
            </div>
        </header>

        <article class="machine-content">
            <div id="content-en" class="lang-content">
                <div class="machine-summary">
                    <h2 data-i18n="summary-title">Exploitation Summary</h2>
                    <p><strong>Exploitation process:</strong> Discovered a web app that allows uploading Chrome addons.
                        Created a malicious addon to exfiltrate cookies and internal domains, discovering
                        <code>browsedinternals.htb</code>. Identified a local Flask app vulnerable to Arithmetic
                        Expansion RCE in a shell script, accessed via the addon. Gained access as <code>larry</code>.
                        Root escalation was achieved by poisoning the <code>__pycache__</code> of a Python script
                        runnable with sudo permissions.
                    </p>
                    <p><strong>Technologies/Exploits:</strong> Chrome Addon Exfiltration, Arithmetic Expansion RCE,
                        PyCache Poisoning.</p>
                </div>
                <div class="restricted-notice">
                    <h3 data-i18n="restricted-title">RESTRICTED CONTENT</h3>
                    <p data-i18n="restricted-text">This machine is currently active on Hack The Box. To follow the rules
                        and maintain the challenge integrity, the full writeup is not available yet.</p>
                </div>
            </div>

            <div id="content-es" class="lang-content" style="display:none;">
                <div class="machine-summary">
                    <h2 data-i18n="summary-title">Resumen de Explotaci√≥n</h2>
                    <p><strong>Resumen del proceso:</strong> Se descubri√≥ una aplicaci√≥n web que permit√≠a subir
                        extensiones de Chrome. Se cre√≥ una extensi√≥n maliciosa para filtrar cookies y dominios internos,
                        descubriendo <code>browsedinternals.htb</code>. Se identific√≥ una aplicaci√≥n Flask local
                        vulnerable a RCE por expansi√≥n aritm√©tica en un script de bash, accesible a trav√©s de la
                        extensi√≥n. Se obtuvo acceso como <code>larry</code>. La escalada a root se logr√≥ mediante el
                        envenenamiento del <code>__pycache__</code> de un script de Python que se pod√≠a ejecutar con
                        permisos de sudo.</p>
                    <p><strong>Tecnolog√≠as/Exploits:</strong> Chrome Addon Exfiltration, Arithmetic Expansion RCE,
                        PyCache Poisoning.</p>
                </div>
                <div class="restricted-notice">
                    <h3 data-i18n="restricted-title">CONTENIDO RESTRINGIDO</h3>
                    <p data-i18n="restricted-text">Esta m√°quina est√° activa actualmente en Hack The Box. Para cumplir
                        con las reglas y mantener la integridad del desaf√≠o, el writeup completo a√∫n no est√° disponible.
                    </p>
                </div>
            </div>
        </article>
    </main>
    <script src="../../index.js"></script>
</body>

</html>